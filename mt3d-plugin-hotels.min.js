/*!
 * mt3d-plugin-hotels v0.1.0
 * https://minitokyo3d.com
 * (c) 2024 Akihiko Kusanagi
 * Released under the MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("mini-tokyo-3d")):"function"==typeof define&&define.amd?define(["mini-tokyo-3d"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).mt3dHotels=t(e.mt3d)}(this,(function(e){"use strict";!function(e,t){void 0===t&&(t={});var o=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===o&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}(".hotel-panel{height:262px!important}.hotel-panel.collapsed{height:50px!important}.hotel-panel.closed{height:0!important}.hotel-marker{background:#fff no-repeat 50%/20px url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 640 512' fill='%23333'%3E%3C!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--%3E%3Cpath d='M32 32c17.7 0 32 14.3 32 32v256h224V160c0-17.7 14.3-32 32-32h224c53 0 96 43 96 96v224c0 17.7-14.3 32-32 32s-32-14.3-32-32v-32H64v32c0 17.7-14.3 32-32 32S0 465.7 0 448V64c0-17.7 14.3-32 32-32zm144 96a80 80 0 1 1 0 160 80 80 0 1 1 0-160z'/%3E%3C/svg%3E\");border:2px solid #333;border-radius:50%;cursor:pointer;height:40px;width:40px}.hotel-marker.active,.hotel-marker:hover{background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 640 512' fill='%2333B5E5'%3E%3C!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--%3E%3Cpath d='M32 32c17.7 0 32 14.3 32 32v256h224V160c0-17.7 14.3-32 32-32h224c53 0 96 43 96 96v224c0 17.7-14.3 32-32 32s-32-14.3-32-32v-32H64v32c0 17.7-14.3 32-32 32S0 465.7 0 448V64c0-17.7 14.3-32 32-32zm144 96a80 80 0 1 1 0 160 80 80 0 1 1 0-160z'/%3E%3C/svg%3E\");border-color:#33b5e5}");function t(e,t){const o=t.replace("#","%23");return e.replace("%3e",` fill='${o}' stroke='${o}'%3e`)}function o(e,t,o){const n=document.createElement(e);return Object.assign(n,t),o&&o.appendChild(n),n}class n extends e.Panel{constructor(e){super(Object.assign({className:"hotel-panel"},e))}addTo(e){const t=this,{name:o,address:n,phone:s,url:i,thumbnail:a}=t._options.hotel;super.addTo(e).setTitle(o).setHTML(['<div class="thumbnail-image-container">','<div class="ball-pulse"><div></div><div></div><div></div></div>',`<div class="thumbnail-image" style="background-image: url('${a}');"></div>`,"</div>",`<div style="margin-top: 8px;"><span style="font-weight: bold;">住所</span>: ${n}</div>`,`<div style="margin-top: 4px;"><span style="font-weight: bold;">電話番号</span>: ${s}</div>`,'<div style="margin-top: 4px;"><span style="font-weight: bold;">空室あり</span></div>','<div id="booking-button" style="width: 100%; height: 39px; margin: 8px 0 1px 0; border-radius: 10px; box-shadow:0 0 0 1px #777; line-height: 39px; text-align: center; cursor: pointer;">プランを見る</div>'].join(""));return t._container.querySelector("#booking-button").addEventListener("click",(()=>{open(i,"_blank")})),t}}class s{constructor(){const e=this;e.id="hotels",e.name={en:"Hotel Info For Last Train Passengers",fr:"Infos Sur Les Hôtels",ja:"終電ホテル情報",ko:"종전 호텔 정보",ne:"होटल जानकारी",pt:"Informações de hotéis",th:"ข้อมูลโรงแรม","zh-Hans":"末班车酒店信息","zh-Hant":"末班車飯店資訊"},e.iconStyle={backgroundSize:"32px",backgroundImage:`url("${t("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 640 512'%3e%3c!--! Font Awesome Free 6.5.2 by %40fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0%2c Fonts: SIL OFL 1.1%2c Code: MIT License) Copyright 2024 Fonticons%2c Inc. --%3e%3cpath d='M32 32c17.7 0 32 14.3 32 32V320H288V160c0-17.7 14.3-32 32-32H544c53 0 96 43 96 96V448c0 17.7-14.3 32-32 32s-32-14.3-32-32V416H352 320 64v32c0 17.7-14.3 32-32 32s-32-14.3-32-32V64C0 46.3 14.3 32 32 32zm144 96a80 80 0 1 1 0 160 80 80 0 1 1 0-160z'/%3e%3c/svg%3e","white")}")`},e.clockModes=["realtime"],e.viewModes=["ground"],e.hotels={},e.markers={},e._onSelection=e._onSelection.bind(e),e._onDeselection=e._onDeselection.bind(e)}onAdd(e){this.map=e}onEnabled(){const e=this,{map:t,hotels:o}=e;t.on("selection",e._onSelection),t.on("deselection",e._onDeselection),fetch("https://mini-tokyo.appspot.com/hotels").then((e=>e.json())).then((t=>{for(const e of t)o[e.id]=e;e._addMarkers()}))}onDisabled(){const e=this,{map:t}=e;t.off("selection",e._onSelection),t.off("deselection",e._onDeselection),e.panel&&(t.trackObject(),e.panel.remove(),delete e.panel);for(const t of Object.keys(e.hotels))delete e.hotels[t];for(const t of Object.keys(e.markers))e.markers[t].remove(),delete e.markers[t]}onVisibilityChanged(e){const t=this;t.visible=e,!e&&t.panel&&t.map.trackObject();for(const o of Object.keys(t.markers))t.markers[o].setVisibility(e)}_addMarkers(){const t=this,{map:n,visible:s}=t;for(const i of Object.keys(t.hotels)){const{center:a,name:c,thumbnail:l}=t.hotels[i],r=o("div",{className:"hotel-marker"}),d={id:i,selectionType:"hotel"};let m;t.markers[i]=new e.Marker({element:r}).setLngLat(a).addTo(n).setVisibility(s).on("click",(()=>{n.trackObject(d),n.getMapboxMap().flyTo({center:a,zoom:17})})).on("mouseenter",(()=>{m=(new e.Popup).setLngLat(a).setHTML(['<div class="thumbnail-image-container">','<div class="ball-pulse"><div></div><div></div><div></div></div>',`<div class="thumbnail-image" style="background-image: url('${l}');"></div>`,"</div>",`<div><strong>${c}</strong></div>`].join("")).addTo(n)})).on("mouseleave",(()=>{m&&(m.remove(),m=void 0)}))}}_onSelection(e){if("hotel"===e.selectionType){const t=this,{id:o}=e;t.markers[o].setActivity(!0),t.panel=new n({hotel:t.hotels[o]}).addTo(t.map)}}_onDeselection(e){if("hotel"===e.selectionType){const t=this,o=t.markers[e.id];o&&o.setActivity(!1),t.panel&&(t.panel.remove(),delete t.panel)}}}return function(){return new s}}));
//# sourceMappingURL=mt3d-plugin-hotels.min.js.map
