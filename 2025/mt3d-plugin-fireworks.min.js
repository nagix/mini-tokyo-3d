/*!
 * mt3d-plugin-fireworks v1.2.0
 * https://minitokyo3d.com
 * (c) 2021-2024 Akihiko Kusanagi
 * Released under the MIT license
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("mini-tokyo-3d")):"function"==typeof define&&define.amd?define(["mini-tokyo-3d"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).mt3dFireworks=t(e.mt3d)}(this,(function(e){"use strict";!function(e,t){void 0===t&&(t={});var s=t.insertAt;if(e&&"undefined"!=typeof document){var c=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===s&&c.firstChild?c.insertBefore(r,c.firstChild):c.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}}(".fireworks-marker {\n    padding: 10px;\n    border-radius: 20px;\n    background-color: rgba(0, 0, 0, 0.7);\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n    color: #fff;\n    cursor: pointer;\n}\n.fireworks-marker::before {\n    content: \"\";\n    display: block;\n    background: no-repeat center/20px 20px url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60' fill='%23fff'%3E%3Cpath d='m39 0c-0.552 0-1 0.447-1 1v11c0 0.553 0.448 1 1 1s1-0.447 1-1v-11c0-0.553-0.448-1-1-1zm-6.977 1.004c-0.1297-0.008047-0.2643 0.007734-0.3945 0.05273-0.521 0.185-0.7934 0.7554-0.6094 1.275l3.664 10.37c0.145 0.411 0.5314 0.666 0.9434 0.666 0.11 0 0.222-0.01864 0.332-0.05664 0.521-0.185 0.7934-0.7554 0.6094-1.275l-3.662-10.37c-0.138-0.3908-0.4938-0.6399-0.8828-0.6641zm14.91 0.4922c-0.3895-0.002859-0.7623 0.224-0.9258 0.6035l-4.361 10.1c-0.219 0.507 0.01548 1.095 0.5215 1.314 0.129 0.056 0.2625 0.08203 0.3945 0.08203 0.387 0 0.755-0.2255 0.918-0.6035l4.361-10.1c0.219-0.507-0.01548-1.096-0.5215-1.314-0.1262-0.05475-0.2569-0.08108-0.3867-0.08203zm-22.08 4.361c-0.2558 0-0.5115 0.09747-0.707 0.293-0.391 0.391-0.391 1.023 0 1.414l7.779 7.779c0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293c0.391-0.391 0.391-1.023 0-1.414l-7.779-7.779c-0.1955-0.1955-0.4513-0.293-0.707-0.293zm28.29 0c-0.2558 0-0.5115 0.09747-0.707 0.293l-7.779 7.779c-0.391 0.39-0.391 1.023 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293l7.779-7.779c0.391-0.391 0.391-1.023 0-1.414-0.1955-0.1955-0.4513-0.293-0.707-0.293zm-32.5 6.449c-0.3899-0.002719-0.7623 0.2221-0.9258 0.6016-0.22 0.507 0.01448 1.097 0.5215 1.316l10.1 4.359c0.129 0.056 0.2625 0.08203 0.3945 0.08203 0.387 0 0.755-0.2255 0.918-0.6035 0.219-0.507-0.01353-1.096-0.5195-1.314l-10.1-4.359c-0.127-0.0545-0.2587-0.08112-0.3887-0.08203zm37.27 0.8926c-0.1297-0.008094-0.2638 0.009937-0.3945 0.05469l-10.37 3.664c-0.521 0.185-0.7934 0.7554-0.6094 1.275 0.145 0.411 0.5314 0.666 0.9434 0.666 0.11 0 0.222-0.01864 0.332-0.05664l10.37-3.664c0.521-0.185 0.7934-0.7554 0.6094-1.275-0.1388-0.3908-0.4918-0.6398-0.8809-0.6641zm-18.92 1.801c-3.309 0-6 2.691-6 6s2.691 6 6 6 6-2.691 6-6-2.691-6-6-6zm-20 5c-0.552 0-1 0.447-1 1s0.448 1 1 1h11c0.552 0 1-0.447 1-1s-0.448-1-1-1h-11zm29 0c-0.553 0-1 0.447-1 1s0.447 1 1 1h11c0.553 0 1-0.447 1-1s-0.447-1-1-1h-11zm-33 1c-0.552 0-1 0.447-1 1v2c0 0.553 0.448 1 1 1s1-0.447 1-1v-2c0-0.553-0.448-1-1-1zm-4.879 1.01c-0.1289-0.01612-0.2618-0.009407-0.3945 0.02734-0.532 0.152-0.8395 0.7053-0.6875 1.236l0.5488 1.924c0.125 0.439 0.5259 0.7266 0.9609 0.7266 0.091 0 0.1844-0.01406 0.2754-0.03906 0.531-0.152 0.8385-0.7053 0.6875-1.236l-0.5488-1.922c-0.114-0.3982-0.4551-0.6684-0.8418-0.7168zm10.94 0.9922c-0.3893-0.02452-0.7737 0.1803-0.959 0.5508l-0.7637 1.527c-0.248 0.495-0.04773 1.097 0.4473 1.344 0.144 0.071 0.2953 0.1035 0.4453 0.1035 0.367 0 0.7205-0.2017 0.8965-0.5527l0.7637-1.527c0.247-0.494 0.04674-1.095-0.4473-1.342-0.124-0.06125-0.253-0.09534-0.3828-0.1035zm9.531 0.2344c-0.1294-0.01069-0.2635 0.003625-0.3945 0.04688l-6.514 2.145c-0.525 0.173-0.8097 0.7387-0.6367 1.264 0.138 0.421 0.5292 0.6875 0.9492 0.6875 0.104 0 0.2095-0.01483 0.3125-0.04883l6.514-2.146c0.525-0.173 0.8097-0.7367 0.6367-1.262-0.1298-0.3938-0.4791-0.6535-0.8672-0.6855zm16.67 0.1895c-0.3899-0.00314-0.7603 0.224-0.9238 0.6035-0.219 0.507 0.01353 1.096 0.5195 1.314l10.1 4.359c0.129 0.056 0.2645 0.08203 0.3965 0.08203 0.388 0 0.755-0.2255 0.918-0.6035 0.218-0.505-0.01448-1.094-0.5215-1.312l-10.1-4.361c-0.127-0.05525-0.2587-0.08098-0.3887-0.08203zm-42.18 1.578c-0.2549-0.023-0.519 0.05202-0.7305 0.2285-0.424 0.354-0.48 0.9832-0.127 1.408l1.279 1.537c0.198 0.237 0.4825 0.3574 0.7695 0.3574 0.226 0 0.4536-0.07547 0.6406-0.2305 0.424-0.354 0.481-0.9842 0.127-1.408l-1.281-1.537c-0.177-0.2125-0.4229-0.3325-0.6777-0.3555zm9.91 0.9961c-0.552 0-1 0.447-1 1v2c0 0.553 0.448 1 1 1s1-0.447 1-1v-2c0-0.553-0.448-1-1-1zm17.64 0.3633c-0.2558 0-0.5115 0.09747-0.707 0.293l-6.637 6.637c-0.391 0.391-0.391 1.023 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293l6.637-6.637c0.391-0.391 0.391-1.023 0-1.414-0.1955-0.1955-0.4513-0.293-0.707-0.293zm12.73 0c-0.2558 0-0.5115 0.09747-0.707 0.293-0.391 0.391-0.391 1.023 0 1.414l7.779 7.779c0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293c0.391-0.391 0.391-1.023 0-1.414l-7.779-7.779c-0.1955-0.1955-0.4513-0.293-0.707-0.293zm-33.87 0.4531c-0.129-0.01617-0.2618-0.007203-0.3945 0.0293-0.531 0.152-0.8385 0.7034-0.6875 1.234l0.5488 1.924c0.126 0.44 0.5259 0.7266 0.9609 0.7266 0.091 0 0.1844-0.01406 0.2754-0.03906 0.531-0.152 0.8385-0.7053 0.6875-1.236l-0.5488-1.922c-0.1133-0.3982-0.4549-0.6683-0.8418-0.7168zm7.465 0.3965c-0.3897-0.02438-0.7737 0.1803-0.959 0.5508l-0.8945 1.789c-0.247 0.494-0.04674 1.095 0.4473 1.342 0.144 0.071 0.2953 0.1055 0.4453 0.1055 0.367 0 0.7205-0.2017 0.8965-0.5527l0.8945-1.789c0.247-0.494 0.04869-1.095-0.4453-1.342-0.1242-0.0615-0.2549-0.09539-0.3848-0.1035zm16.48 0.9082c-0.3899-0.002719-0.7603 0.2221-0.9238 0.6016l-4.361 10.1c-0.219 0.507 0.01548 1.096 0.5215 1.314 0.129 0.056 0.2625 0.08203 0.3945 0.08203 0.387 0 0.755-0.2275 0.918-0.6055l4.361-10.1c0.219-0.505-0.01548-1.095-0.5215-1.314-0.127-0.0545-0.2587-0.07917-0.3887-0.08008zm6.617 0.2266c-0.1297-0.008047-0.2623 0.007735-0.3926 0.05274-0.521 0.185-0.7934 0.7573-0.6094 1.277l3.664 10.37c0.145 0.411 0.5294 0.668 0.9414 0.668 0.11 0 0.224-0.02059 0.334-0.05859 0.521-0.185 0.7934-0.7554 0.6094-1.275l-3.664-10.37c-0.138-0.3908-0.4938-0.6399-0.8828-0.6641zm-3.057 0.4062c-0.552 0-1 0.447-1 1v7.525c0 0.553 0.448 1 1 1s1-0.447 1-1v-7.525c0-0.553-0.448-1-1-1zm-30.71 0.08984c-0.2549-0.023-0.519 0.05202-0.7305 0.2285-0.424 0.354-0.48 0.9842-0.127 1.408l1.281 1.537c0.198 0.238 0.4806 0.3594 0.7676 0.3594 0.226 0 0.4536-0.07547 0.6406-0.2305 0.423-0.353 0.48-0.9842 0.127-1.408l-1.281-1.539c-0.177-0.2125-0.4229-0.3325-0.6777-0.3555zm16.46 0.1562c-0.552 0-0.9961 0.447-0.9961 1s0.4539 1 1.006 1c0.553 0 1-0.447 1-1s-0.447-1-1-1h-0.009766zm-22.75 0.998c-0.39-0.002625-0.7611 0.2264-0.9238 0.6074-0.218 0.507 0.01739 1.096 0.5254 1.314l1.838 0.7871c0.128 0.056 0.2625 0.08008 0.3945 0.08008 0.388 0 0.7579-0.2265 0.9199-0.6055 0.218-0.507-0.01739-1.094-0.5254-1.312l-1.838-0.7891c-0.1272-0.0555-0.2606-0.08116-0.3906-0.08203zm20.49 0.8125c-0.2532-0.03612-0.5202 0.02591-0.7422 0.1914l-1.6 1.199c-0.442 0.331-0.5322 0.9574-0.2012 1.398 0.196 0.262 0.4968 0.4004 0.8008 0.4004 0.208 0 0.4196-0.06422 0.5996-0.1992l1.6-1.201c0.442-0.331 0.5322-0.9574 0.2012-1.398-0.165-0.221-0.405-0.3545-0.6582-0.3906zm-15.9 1.158c-0.3897-0.002203-0.7611 0.2264-0.9238 0.6074-0.218 0.507 0.01544 1.094 0.5234 1.312l1.838 0.7891c0.128 0.056 0.2625 0.08008 0.3945 0.08008 0.388 0 0.7579-0.2265 0.9199-0.6055 0.218-0.507-0.01739-1.094-0.5254-1.312l-1.838-0.7891c-0.1268-0.05475-0.2588-0.0813-0.3887-0.08203zm8.223 0.7539c-1.919 0-3.48 1.56-3.48 3.479 0 1.919 1.562 3.48 3.48 3.48 1.919 0 3.479-1.562 3.479-3.48 0-1.919-1.56-3.479-3.479-3.479zm-13.82 2.654c-0.552 0-1 0.447-1 1s0.448 1 1 1h2c0.552 0 1-0.447 1-1s-0.448-1-1-1h-2zm5 0c-0.552 0-1 0.447-1 1s0.448 1 1 1h2c0.552 0 1-0.447 1-1s-0.448-1-1-1h-2zm15.62 0.2441c-0.552 0-1 0.447-1 1s0.448 1 1 1h2c0.552 0 1-0.447 1-1s-0.448-1-1-1h-2zm6.395 0.0293c-0.552 0-0.9961 0.447-0.9961 1s0.4539 1 1.006 1c0.553 0 1-0.447 1-1s-0.447-1-1-1h-0.009766zm-19.16 2.436c-0.129-0.01617-0.2637-0.007204-0.3965 0.0293l-1.922 0.5488c-0.531 0.152-0.8395 0.7053-0.6875 1.236 0.125 0.44 0.5259 0.7266 0.9609 0.7266 0.091 0 0.1834-0.01406 0.2754-0.03906l1.924-0.5488c0.531-0.152 0.8375-0.7053 0.6855-1.236-0.1132-0.3982-0.4529-0.6683-0.8398-0.7168zm12.13 0.9121c-0.3902 0.0075-0.7552 0.2454-0.9082 0.6309-0.206 0.513 0.04364 1.096 0.5566 1.301l1.857 0.7422c0.122 0.049 0.2481 0.07031 0.3711 0.07031 0.397 0 0.7707-0.2369 0.9277-0.6289 0.205-0.512-0.04464-1.093-0.5566-1.299l-1.857-0.7441c-0.1288-0.0515-0.2605-0.07476-0.3906-0.07226zm18.02 0.1699c-0.552 0-1 0.447-1 1v2.889c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.889c0-0.553-0.448-1-1-1zm-34.96 0.291c-0.1289-0.01611-0.2635-0.007453-0.3965 0.0293l-1.924 0.5488c-0.531 0.152-0.8385 0.7073-0.6875 1.238 0.126 0.439 0.5269 0.7246 0.9629 0.7246 0.091 0 0.1844-0.01211 0.2754-0.03711l1.922-0.5508c0.531-0.152 0.8395-0.7053 0.6875-1.236-0.114-0.3975-0.453-0.6685-0.8398-0.7168zm5.904 0.5898c-0.256 0-0.5115 0.09942-0.707 0.2949l-1.414 1.414c-0.39 0.391-0.39 1.024 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293 0.256 0 0.512-0.09797 0.707-0.293l1.414-1.414c0.39-0.391 0.39-1.024 0-1.414-0.1955-0.1955-0.451-0.2949-0.707-0.2949zm15.67 0.8066c-0.3897 0.007875-0.7545 0.2461-0.9082 0.6309-0.205 0.513 0.04559 1.095 0.5586 1.299l0.3574 0.1445c0.121 0.049 0.2451 0.07031 0.3691 0.07031 0.397 0 0.7737-0.2389 0.9297-0.6309 0.204-0.513-0.04659-1.095-0.5586-1.299l-0.3574-0.1426c-0.1288-0.05175-0.2607-0.07489-0.3906-0.07226zm-7.434 0.541c-0.1275 0.02431-0.2524 0.07389-0.3672 0.1504-0.459 0.307-0.5814 0.9267-0.2754 1.387l1.107 1.664c0.193 0.289 0.511 0.4453 0.834 0.4453 0.19 0 0.3837-0.05497 0.5547-0.168 0.46-0.307 0.5824-0.9267 0.2754-1.387l-1.107-1.664c-0.231-0.345-0.639-0.5007-1.021-0.4277zm-6.127 0.6055c-0.3892-0.02466-0.7718 0.1803-0.957 0.5508l-0.7637 1.527c-0.247 0.494-0.04869 1.095 0.4453 1.342 0.144 0.071 0.2973 0.1055 0.4473 0.1055 0.367 0 0.7205-0.2017 0.8965-0.5527l0.7637-1.529c0.248-0.493 0.04674-1.092-0.4473-1.34-0.1238-0.0615-0.255-0.0953-0.3848-0.1035zm2.963 0.4375c-0.552 0-1 0.447-1 1v3.959c0 0.553 0.448 1 1 1s1-0.447 1-1v-3.959c0-0.553-0.448-1-1-1zm-8.611 1.146c-0.2558 0-0.5115 0.09747-0.707 0.293l-1.414 1.414c-0.391 0.391-0.391 1.023 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293l1.414-1.414c0.391-0.391 0.391-1.023 0-1.414-0.1955-0.1955-0.4513-0.293-0.707-0.293zm32.59 1.357c-0.552 0-1 0.447-1 1v2.891c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.891c0-0.552-0.448-1-1-1zm-18.04 0.6113c-0.1276 0.02436-0.2522 0.07559-0.3672 0.1523-0.46 0.307-0.5833 0.9267-0.2773 1.387l1.109 1.664c0.193 0.289 0.511 0.4453 0.834 0.4453 0.19 0 0.3817-0.05497 0.5527-0.168 0.459-0.307 0.5843-0.9287 0.2773-1.389l-1.109-1.662c-0.2302-0.345-0.6367-0.5028-1.02-0.4297zm-11 0.6582c-0.3892-0.02438-0.7737 0.1803-0.959 0.5508l-0.8945 1.789c-0.247 0.494-0.04673 1.095 0.4473 1.342 0.144 0.071 0.2953 0.1055 0.4453 0.1055 0.367 0 0.7205-0.2017 0.8965-0.5527l0.8945-1.789c0.246-0.494 0.04674-1.095-0.4473-1.342-0.1238-0.0615-0.2531-0.09539-0.3828-0.1035zm5.066 3.072c-0.552 0-1 0.447-1 1v2.891c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.891c0-0.552-0.448-1-1-1zm23.97 1.438c-0.552 0-1 0.447-1 1v2.889c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.889c0-0.553-0.448-1-1-1zm-23.97 4.342c-0.552 0-1 0.447-1 1v2.889c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.889c0-0.553-0.448-1-1-1zm23.97 1.436c-0.552 0-1 0.447-1 1v1.5c0 0.553 0.448 1 1 1s1-0.447 1-1v-1.5c0-0.553-0.448-1-1-1z'/%3E%3C/svg%3E\");\n    width: 20px;\n    height: 20px;\n    float: left;\n    margin: 0 6px 0 0;\n}\n.fireworks-marker:hover {\n    background-color: rgba(51, 51, 51, 0.7);\n}\n.fireworks-ctrl {\n    height: 100%;\n    padding: 10px 0 9px 0;\n    border-radius: 10px;\n    background-color: rgba(0, 0, 0, 0.7);\n    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n    color: #fff;\n    pointer-events: auto;\n}\n.fireworks-header {\n    width: 100%;\n    padding: 0 10px;\n    margin-bottom: 9px;\n    box-sizing: border-box;\n    display: table;\n}\n.fireworks-header > div {\n    height: 39px;\n    margin-bottom: 4px;\n    vertical-align: middle;\n    display: table-cell;\n}\n.fireworks-title {\n    line-height: 19.5px;\n    padding-right: 10px;\n    font-weight: bold;\n}\n.fireworks-expand-button {\n    width: 39px;\n    height: 39px;\n    transform: scaleX(-1);\n    border-radius: 10px;\n    box-shadow: 0 0 0 1px #777;\n    display: block;\n    background: no-repeat center/18px 18px url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' fill='%23fff'%3E%3C!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --%3E%3Cpath d='M344 0H488c13.3 0 24 10.7 24 24V168c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-39-39-87 87c-9.4 9.4-24.6 9.4-33.9 0l-32-32c-9.4-9.4-9.4-24.6 0-33.9l87-87L327 41c-6.9-6.9-8.9-17.2-5.2-26.2S334.3 0 344 0zM168 512H24c-13.3 0-24-10.7-24-24V344c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l39 39 87-87c9.4-9.4 24.6-9.4 33.9 0l32 32c9.4 9.4 9.4 24.6 0 33.9l-87 87 39 39c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8z'/%3E%3C/svg%3E\");\n    cursor: pointer;\n}\n.expanded .fireworks-expand-button {\n    background: no-repeat center/18px 18px url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' fill='%23fff'%3E%3C!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc. --%3E%3Cpath d='M439 7c9.4-9.4 24.6-9.4 33.9 0l32 32c9.4 9.4 9.4 24.6 0 33.9l-87 87 39 39c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8H296c-13.3 0-24-10.7-24-24V72c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2l39 39L439 7zM72 272H216c13.3 0 24 10.7 24 24V440c0 9.7-5.8 18.5-14.8 22.2s-19.3 1.7-26.2-5.2l-39-39L73 505c-9.4 9.4-24.6 9.4-33.9 0L7 473c-9.4-9.4-9.4-24.6 0-33.9l87-87L55 313c-6.9-6.9-8.9-17.2-5.2-26.2s12.5-14.8 22.2-14.8z'/%3E%3C/svg%3E\");\n}\n.fireworks-expand-button:hover {\n    background-color: rgba(51, 51, 51, 0.7);\n}\n.fireworks-body {\n    height: calc(100% - 48px);\n    overflow: auto;\n    overscroll-behavior: contain;\n}\n.fireworks-content {\n    padding: 1px 10px;\n    overflow: hidden;\n}\n.fireworks-list {\n    display: none;\n}\n.fireworks-event {\n    width: 122px;\n    height: 39px;\n    padding: 0 6px;\n    border: 0;\n    border-radius: 10px;\n    box-shadow: 0 0 0 1px #777;\n    display: block;\n    color: #fff;\n    background-color: transparent;\n    cursor: pointer;\n}\n.fireworks-list .fireworks-event {\n    margin-top: 10px;\n}\n.fireworks-event:hover {\n    background-color: rgba(51, 51, 51, 0.7);\n}\n.fireworks-event::before {\n    content: \"\";\n    display: block;\n    background: no-repeat center/20px 20px url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60' fill='%23fff'%3E%3Cpath d='m39 0c-0.552 0-1 0.447-1 1v11c0 0.553 0.448 1 1 1s1-0.447 1-1v-11c0-0.553-0.448-1-1-1zm-6.977 1.004c-0.1297-0.008047-0.2643 0.007734-0.3945 0.05273-0.521 0.185-0.7934 0.7554-0.6094 1.275l3.664 10.37c0.145 0.411 0.5314 0.666 0.9434 0.666 0.11 0 0.222-0.01864 0.332-0.05664 0.521-0.185 0.7934-0.7554 0.6094-1.275l-3.662-10.37c-0.138-0.3908-0.4938-0.6399-0.8828-0.6641zm14.91 0.4922c-0.3895-0.002859-0.7623 0.224-0.9258 0.6035l-4.361 10.1c-0.219 0.507 0.01548 1.095 0.5215 1.314 0.129 0.056 0.2625 0.08203 0.3945 0.08203 0.387 0 0.755-0.2255 0.918-0.6035l4.361-10.1c0.219-0.507-0.01548-1.096-0.5215-1.314-0.1262-0.05475-0.2569-0.08108-0.3867-0.08203zm-22.08 4.361c-0.2558 0-0.5115 0.09747-0.707 0.293-0.391 0.391-0.391 1.023 0 1.414l7.779 7.779c0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293c0.391-0.391 0.391-1.023 0-1.414l-7.779-7.779c-0.1955-0.1955-0.4513-0.293-0.707-0.293zm28.29 0c-0.2558 0-0.5115 0.09747-0.707 0.293l-7.779 7.779c-0.391 0.39-0.391 1.023 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293l7.779-7.779c0.391-0.391 0.391-1.023 0-1.414-0.1955-0.1955-0.4513-0.293-0.707-0.293zm-32.5 6.449c-0.3899-0.002719-0.7623 0.2221-0.9258 0.6016-0.22 0.507 0.01448 1.097 0.5215 1.316l10.1 4.359c0.129 0.056 0.2625 0.08203 0.3945 0.08203 0.387 0 0.755-0.2255 0.918-0.6035 0.219-0.507-0.01353-1.096-0.5195-1.314l-10.1-4.359c-0.127-0.0545-0.2587-0.08112-0.3887-0.08203zm37.27 0.8926c-0.1297-0.008094-0.2638 0.009937-0.3945 0.05469l-10.37 3.664c-0.521 0.185-0.7934 0.7554-0.6094 1.275 0.145 0.411 0.5314 0.666 0.9434 0.666 0.11 0 0.222-0.01864 0.332-0.05664l10.37-3.664c0.521-0.185 0.7934-0.7554 0.6094-1.275-0.1388-0.3908-0.4918-0.6398-0.8809-0.6641zm-18.92 1.801c-3.309 0-6 2.691-6 6s2.691 6 6 6 6-2.691 6-6-2.691-6-6-6zm-20 5c-0.552 0-1 0.447-1 1s0.448 1 1 1h11c0.552 0 1-0.447 1-1s-0.448-1-1-1h-11zm29 0c-0.553 0-1 0.447-1 1s0.447 1 1 1h11c0.553 0 1-0.447 1-1s-0.447-1-1-1h-11zm-33 1c-0.552 0-1 0.447-1 1v2c0 0.553 0.448 1 1 1s1-0.447 1-1v-2c0-0.553-0.448-1-1-1zm-4.879 1.01c-0.1289-0.01612-0.2618-0.009407-0.3945 0.02734-0.532 0.152-0.8395 0.7053-0.6875 1.236l0.5488 1.924c0.125 0.439 0.5259 0.7266 0.9609 0.7266 0.091 0 0.1844-0.01406 0.2754-0.03906 0.531-0.152 0.8385-0.7053 0.6875-1.236l-0.5488-1.922c-0.114-0.3982-0.4551-0.6684-0.8418-0.7168zm10.94 0.9922c-0.3893-0.02452-0.7737 0.1803-0.959 0.5508l-0.7637 1.527c-0.248 0.495-0.04773 1.097 0.4473 1.344 0.144 0.071 0.2953 0.1035 0.4453 0.1035 0.367 0 0.7205-0.2017 0.8965-0.5527l0.7637-1.527c0.247-0.494 0.04674-1.095-0.4473-1.342-0.124-0.06125-0.253-0.09534-0.3828-0.1035zm9.531 0.2344c-0.1294-0.01069-0.2635 0.003625-0.3945 0.04688l-6.514 2.145c-0.525 0.173-0.8097 0.7387-0.6367 1.264 0.138 0.421 0.5292 0.6875 0.9492 0.6875 0.104 0 0.2095-0.01483 0.3125-0.04883l6.514-2.146c0.525-0.173 0.8097-0.7367 0.6367-1.262-0.1298-0.3938-0.4791-0.6535-0.8672-0.6855zm16.67 0.1895c-0.3899-0.00314-0.7603 0.224-0.9238 0.6035-0.219 0.507 0.01353 1.096 0.5195 1.314l10.1 4.359c0.129 0.056 0.2645 0.08203 0.3965 0.08203 0.388 0 0.755-0.2255 0.918-0.6035 0.218-0.505-0.01448-1.094-0.5215-1.312l-10.1-4.361c-0.127-0.05525-0.2587-0.08098-0.3887-0.08203zm-42.18 1.578c-0.2549-0.023-0.519 0.05202-0.7305 0.2285-0.424 0.354-0.48 0.9832-0.127 1.408l1.279 1.537c0.198 0.237 0.4825 0.3574 0.7695 0.3574 0.226 0 0.4536-0.07547 0.6406-0.2305 0.424-0.354 0.481-0.9842 0.127-1.408l-1.281-1.537c-0.177-0.2125-0.4229-0.3325-0.6777-0.3555zm9.91 0.9961c-0.552 0-1 0.447-1 1v2c0 0.553 0.448 1 1 1s1-0.447 1-1v-2c0-0.553-0.448-1-1-1zm17.64 0.3633c-0.2558 0-0.5115 0.09747-0.707 0.293l-6.637 6.637c-0.391 0.391-0.391 1.023 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293l6.637-6.637c0.391-0.391 0.391-1.023 0-1.414-0.1955-0.1955-0.4513-0.293-0.707-0.293zm12.73 0c-0.2558 0-0.5115 0.09747-0.707 0.293-0.391 0.391-0.391 1.023 0 1.414l7.779 7.779c0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293c0.391-0.391 0.391-1.023 0-1.414l-7.779-7.779c-0.1955-0.1955-0.4513-0.293-0.707-0.293zm-33.87 0.4531c-0.129-0.01617-0.2618-0.007203-0.3945 0.0293-0.531 0.152-0.8385 0.7034-0.6875 1.234l0.5488 1.924c0.126 0.44 0.5259 0.7266 0.9609 0.7266 0.091 0 0.1844-0.01406 0.2754-0.03906 0.531-0.152 0.8385-0.7053 0.6875-1.236l-0.5488-1.922c-0.1133-0.3982-0.4549-0.6683-0.8418-0.7168zm7.465 0.3965c-0.3897-0.02438-0.7737 0.1803-0.959 0.5508l-0.8945 1.789c-0.247 0.494-0.04674 1.095 0.4473 1.342 0.144 0.071 0.2953 0.1055 0.4453 0.1055 0.367 0 0.7205-0.2017 0.8965-0.5527l0.8945-1.789c0.247-0.494 0.04869-1.095-0.4453-1.342-0.1242-0.0615-0.2549-0.09539-0.3848-0.1035zm16.48 0.9082c-0.3899-0.002719-0.7603 0.2221-0.9238 0.6016l-4.361 10.1c-0.219 0.507 0.01548 1.096 0.5215 1.314 0.129 0.056 0.2625 0.08203 0.3945 0.08203 0.387 0 0.755-0.2275 0.918-0.6055l4.361-10.1c0.219-0.505-0.01548-1.095-0.5215-1.314-0.127-0.0545-0.2587-0.07917-0.3887-0.08008zm6.617 0.2266c-0.1297-0.008047-0.2623 0.007735-0.3926 0.05274-0.521 0.185-0.7934 0.7573-0.6094 1.277l3.664 10.37c0.145 0.411 0.5294 0.668 0.9414 0.668 0.11 0 0.224-0.02059 0.334-0.05859 0.521-0.185 0.7934-0.7554 0.6094-1.275l-3.664-10.37c-0.138-0.3908-0.4938-0.6399-0.8828-0.6641zm-3.057 0.4062c-0.552 0-1 0.447-1 1v7.525c0 0.553 0.448 1 1 1s1-0.447 1-1v-7.525c0-0.553-0.448-1-1-1zm-30.71 0.08984c-0.2549-0.023-0.519 0.05202-0.7305 0.2285-0.424 0.354-0.48 0.9842-0.127 1.408l1.281 1.537c0.198 0.238 0.4806 0.3594 0.7676 0.3594 0.226 0 0.4536-0.07547 0.6406-0.2305 0.423-0.353 0.48-0.9842 0.127-1.408l-1.281-1.539c-0.177-0.2125-0.4229-0.3325-0.6777-0.3555zm16.46 0.1562c-0.552 0-0.9961 0.447-0.9961 1s0.4539 1 1.006 1c0.553 0 1-0.447 1-1s-0.447-1-1-1h-0.009766zm-22.75 0.998c-0.39-0.002625-0.7611 0.2264-0.9238 0.6074-0.218 0.507 0.01739 1.096 0.5254 1.314l1.838 0.7871c0.128 0.056 0.2625 0.08008 0.3945 0.08008 0.388 0 0.7579-0.2265 0.9199-0.6055 0.218-0.507-0.01739-1.094-0.5254-1.312l-1.838-0.7891c-0.1272-0.0555-0.2606-0.08116-0.3906-0.08203zm20.49 0.8125c-0.2532-0.03612-0.5202 0.02591-0.7422 0.1914l-1.6 1.199c-0.442 0.331-0.5322 0.9574-0.2012 1.398 0.196 0.262 0.4968 0.4004 0.8008 0.4004 0.208 0 0.4196-0.06422 0.5996-0.1992l1.6-1.201c0.442-0.331 0.5322-0.9574 0.2012-1.398-0.165-0.221-0.405-0.3545-0.6582-0.3906zm-15.9 1.158c-0.3897-0.002203-0.7611 0.2264-0.9238 0.6074-0.218 0.507 0.01544 1.094 0.5234 1.312l1.838 0.7891c0.128 0.056 0.2625 0.08008 0.3945 0.08008 0.388 0 0.7579-0.2265 0.9199-0.6055 0.218-0.507-0.01739-1.094-0.5254-1.312l-1.838-0.7891c-0.1268-0.05475-0.2588-0.0813-0.3887-0.08203zm8.223 0.7539c-1.919 0-3.48 1.56-3.48 3.479 0 1.919 1.562 3.48 3.48 3.48 1.919 0 3.479-1.562 3.479-3.48 0-1.919-1.56-3.479-3.479-3.479zm-13.82 2.654c-0.552 0-1 0.447-1 1s0.448 1 1 1h2c0.552 0 1-0.447 1-1s-0.448-1-1-1h-2zm5 0c-0.552 0-1 0.447-1 1s0.448 1 1 1h2c0.552 0 1-0.447 1-1s-0.448-1-1-1h-2zm15.62 0.2441c-0.552 0-1 0.447-1 1s0.448 1 1 1h2c0.552 0 1-0.447 1-1s-0.448-1-1-1h-2zm6.395 0.0293c-0.552 0-0.9961 0.447-0.9961 1s0.4539 1 1.006 1c0.553 0 1-0.447 1-1s-0.447-1-1-1h-0.009766zm-19.16 2.436c-0.129-0.01617-0.2637-0.007204-0.3965 0.0293l-1.922 0.5488c-0.531 0.152-0.8395 0.7053-0.6875 1.236 0.125 0.44 0.5259 0.7266 0.9609 0.7266 0.091 0 0.1834-0.01406 0.2754-0.03906l1.924-0.5488c0.531-0.152 0.8375-0.7053 0.6855-1.236-0.1132-0.3982-0.4529-0.6683-0.8398-0.7168zm12.13 0.9121c-0.3902 0.0075-0.7552 0.2454-0.9082 0.6309-0.206 0.513 0.04364 1.096 0.5566 1.301l1.857 0.7422c0.122 0.049 0.2481 0.07031 0.3711 0.07031 0.397 0 0.7707-0.2369 0.9277-0.6289 0.205-0.512-0.04464-1.093-0.5566-1.299l-1.857-0.7441c-0.1288-0.0515-0.2605-0.07476-0.3906-0.07226zm18.02 0.1699c-0.552 0-1 0.447-1 1v2.889c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.889c0-0.553-0.448-1-1-1zm-34.96 0.291c-0.1289-0.01611-0.2635-0.007453-0.3965 0.0293l-1.924 0.5488c-0.531 0.152-0.8385 0.7073-0.6875 1.238 0.126 0.439 0.5269 0.7246 0.9629 0.7246 0.091 0 0.1844-0.01211 0.2754-0.03711l1.922-0.5508c0.531-0.152 0.8395-0.7053 0.6875-1.236-0.114-0.3975-0.453-0.6685-0.8398-0.7168zm5.904 0.5898c-0.256 0-0.5115 0.09942-0.707 0.2949l-1.414 1.414c-0.39 0.391-0.39 1.024 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293 0.256 0 0.512-0.09797 0.707-0.293l1.414-1.414c0.39-0.391 0.39-1.024 0-1.414-0.1955-0.1955-0.451-0.2949-0.707-0.2949zm15.67 0.8066c-0.3897 0.007875-0.7545 0.2461-0.9082 0.6309-0.205 0.513 0.04559 1.095 0.5586 1.299l0.3574 0.1445c0.121 0.049 0.2451 0.07031 0.3691 0.07031 0.397 0 0.7737-0.2389 0.9297-0.6309 0.204-0.513-0.04659-1.095-0.5586-1.299l-0.3574-0.1426c-0.1288-0.05175-0.2607-0.07489-0.3906-0.07226zm-7.434 0.541c-0.1275 0.02431-0.2524 0.07389-0.3672 0.1504-0.459 0.307-0.5814 0.9267-0.2754 1.387l1.107 1.664c0.193 0.289 0.511 0.4453 0.834 0.4453 0.19 0 0.3837-0.05497 0.5547-0.168 0.46-0.307 0.5824-0.9267 0.2754-1.387l-1.107-1.664c-0.231-0.345-0.639-0.5007-1.021-0.4277zm-6.127 0.6055c-0.3892-0.02466-0.7718 0.1803-0.957 0.5508l-0.7637 1.527c-0.247 0.494-0.04869 1.095 0.4453 1.342 0.144 0.071 0.2973 0.1055 0.4473 0.1055 0.367 0 0.7205-0.2017 0.8965-0.5527l0.7637-1.529c0.248-0.493 0.04674-1.092-0.4473-1.34-0.1238-0.0615-0.255-0.0953-0.3848-0.1035zm2.963 0.4375c-0.552 0-1 0.447-1 1v3.959c0 0.553 0.448 1 1 1s1-0.447 1-1v-3.959c0-0.553-0.448-1-1-1zm-8.611 1.146c-0.2558 0-0.5115 0.09747-0.707 0.293l-1.414 1.414c-0.391 0.391-0.391 1.023 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293l1.414-1.414c0.391-0.391 0.391-1.023 0-1.414-0.1955-0.1955-0.4513-0.293-0.707-0.293zm32.59 1.357c-0.552 0-1 0.447-1 1v2.891c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.891c0-0.552-0.448-1-1-1zm-18.04 0.6113c-0.1276 0.02436-0.2522 0.07559-0.3672 0.1523-0.46 0.307-0.5833 0.9267-0.2773 1.387l1.109 1.664c0.193 0.289 0.511 0.4453 0.834 0.4453 0.19 0 0.3817-0.05497 0.5527-0.168 0.459-0.307 0.5843-0.9287 0.2773-1.389l-1.109-1.662c-0.2302-0.345-0.6367-0.5028-1.02-0.4297zm-11 0.6582c-0.3892-0.02438-0.7737 0.1803-0.959 0.5508l-0.8945 1.789c-0.247 0.494-0.04673 1.095 0.4473 1.342 0.144 0.071 0.2953 0.1055 0.4453 0.1055 0.367 0 0.7205-0.2017 0.8965-0.5527l0.8945-1.789c0.246-0.494 0.04674-1.095-0.4473-1.342-0.1238-0.0615-0.2531-0.09539-0.3828-0.1035zm5.066 3.072c-0.552 0-1 0.447-1 1v2.891c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.891c0-0.552-0.448-1-1-1zm23.97 1.438c-0.552 0-1 0.447-1 1v2.889c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.889c0-0.553-0.448-1-1-1zm-23.97 4.342c-0.552 0-1 0.447-1 1v2.889c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.889c0-0.553-0.448-1-1-1zm23.97 1.436c-0.552 0-1 0.447-1 1v1.5c0 0.553 0.448 1 1 1s1-0.447 1-1v-1.5c0-0.553-0.448-1-1-1z'/%3E%3C/svg%3E\");\n    width: 20px;\n    height: 28px;\n    float: left;\n    margin: 0 6px 0 0;\n}\n.expanded .fireworks-list {\n    display: block;\n}\n.expanded .fireworks-event {\n    width: 100%;\n}\n.fireworks-event-label {\n    height: 28px;\n    font-size: 12px;\n    line-height: 14px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-align: left;\n    text-overflow: ellipsis;\n}\n.fireworks-footer {\n    margin-top: 4px;\n    text-align: right;\n}\n.expanded .fireworks-footer {\n    display: none;\n}\n");const{AdditiveBlending:t,BufferGeometry:s,DynamicDrawUsage:c,Float32BufferAttribute:r,Group:n,MathUtils:a,Points:o,RawShaderMaterial:i,CanvasTexture:l,Vector3:m}=e.THREE;function d(e,t,s){const c=document.createElement(e);return Object.assign(c,t),s&&s.appendChild(c),c}function h(e,t){return e(),setInterval(e,t)}const p=.998,v=e=>{const t=3*e;return{x:t,y:t+1,z:t+2}},f=e=>{const t=4*e;return{r:t,g:t+1,b:t+2,a:t+3}},u=(e=0,t=0)=>Math.floor(Math.random()*(e+1-t))+t,g=(()=>{const e=document.createElement("canvas"),t=e.getContext("2d");e.width=128,e.height=128;return((e,t,s,c)=>{e.save();const r=e.createRadialGradient(t,t,0,t,t,t);r.addColorStop(0,"rgba(255,255,255,1.0)"),r.addColorStop(.5,"rgba(255,255,255,0.5)"),r.addColorStop(1,"rgba(255,255,255,0)"),e.fillStyle=r,e.fillRect(0,0,s,c),e.restore()})(t,64,e.width,e.height),new l(e)})();class z{constructor(e,n,a,l){this.scale=e,this.particleNum=n,this.timerStartFading=10,this.mesh=((e,n,a)=>{const l=new s,d=[],h=[],p=[],v=[],f=[],z=Math.random()>.3?"single":"multiple",y=.01*u(100,20),w=()=>.01*u(100,1);let x;const b=Math.random();x=b>.66?"red":b>.33?"green":"blue";for(let t=0;t<e;t++){const e=new m(0,0,0);if(d.push(e.x,e.y,e.z),h.push(n[t].x,n[t].y,n[t].z),"seed"===a){let e;e=.1*Math.random()+.1,0===t&&(e*=1.1),v.push(5*e),f.push(.017*e),p.push(1,1,1,1)}else{const e=.001*u(300,10);if(v.push(5*e),f.push(.017*e),"multiple"===z)p.push(w(),w(),w(),1);else switch(x){case"red":default:p.push(y,.1,.1,1);break;case"green":p.push(.1,y,.1,1);break;case"blue":p.push(.1,.1,y,1)}}}l.setAttribute("position",new r(d,3).setUsage(c)),l.setAttribute("velocity",new r(h,3).setUsage(c)),l.setAttribute("color",new r(p,4).setUsage(c)),l.setAttribute("adjustSize",new r(v,1).setUsage(c)),l.setAttribute("mass",new r(f,1).setUsage(c));const k=new i({uniforms:{size:{type:"f",value:128},texture:{type:"t",value:g}},transparent:!0,depthWrite:!1,blending:t,vertexShader:"precision highp float;attribute vec3 position;uniform mat4 projectionMatrix;uniform mat4 modelViewMatrix;uniform float size;attribute float adjustSize;uniform vec3 cameraPosition;attribute vec3 velocity;attribute vec4 color;varying vec4 vColor;void main() {vColor=color;vec4 modelViewPosition=modelViewMatrix*vec4(position,1.0);gl_PointSize=size*adjustSize*(100.0/length(modelViewPosition.xyz));gl_Position=projectionMatrix*modelViewPosition;}",fragmentShader:"precision mediump float;uniform sampler2D texture;varying vec4 vColor;void main() {vec4 color=vec4(texture2D(texture,gl_PointCoord));gl_FragColor=color*vColor;}"});return new o(l,k)})(n,a,l)}update(e,t){this.timerStartFading>0&&(this.timerStartFading-=.3);const{position:s,velocity:c,color:r,mass:n}=this.mesh.geometry.attributes;for(let o=0;o<this.particleNum;o++){const{x:i,y:l,z:m}=v(o);c.array[m]+=e.z-n.array[o]*this.scale*t,c.array[i]*=1-(1-p)*t,c.array[l]*=1-(1-p)*t,c.array[m]*=1-(1-p)*t,s.array[i]+=c.array[i]*t,s.array[l]+=c.array[l]*t,s.array[m]+=c.array[m]*t;const{a:d}=f(o);this.timerStartFading<=0&&(r.array[d]*=1-(1-((Math.random()>.5?.98:.96)-(a=r.array[d],Math.random()>.5?0:.1*(1-a))))*t,r.array[d]<.001&&(r.array[d]=0))}var a;s.needsUpdate=!0,c.needsUpdate=!0,r.needsUpdate=!0}disposeAll(){this.mesh.geometry.dispose(),this.mesh.material.dispose()}}class y extends z{constructor(e,t,s){super(e,t,s,"seed")}update(e,t){const{position:s,velocity:c,color:r,mass:n}=this.mesh.geometry.attributes,a=()=>(Math.random()>.5?.05:-.05)*this.scale*t,o=()=>Math.random()>.1,i=.97804;for(let m=0;m<this.particleNum;m++){const{x:d,y:h,z:p}=v(m);c.array[p]+=e.z-n.array[m]*this.scale*t,c.array[d]*=1-(1-i)*t,c.array[h]*=1-(1-i)*t,c.array[p]*=1-(1-i)*t,s.array[d]+=c.array[d]*t,s.array[h]+=c.array[h]*t,s.array[p]+=c.array[p]*t,o()&&(s.array[d]+=a()),o()&&(s.array[h]+=a());const{a:u}=f(m);r.array[u]*=1-(1-((Math.random()>.3?.99:.96)-(l=r.array[u],Math.random()>.3?0:.1*(1-l))))*t,r.array[u]<.001&&(r.array[u]=0)}var l;s.needsUpdate=!0,c.needsUpdate=!0,r.needsUpdate=!0}}class w extends z{constructor(e,t,s){super(e,t,s,"trail")}update(e,t){const{position:s,velocity:c,color:r,mass:n}=this.mesh.geometry.attributes,a=()=>(Math.random()>.5?.05:-.05)*this.scale*t,o=()=>Math.random()>.2;for(let i=0;i<this.particleNum;i++){const{x:l,y:m,z:d}=v(i);c.array[d]+=e.z-n.array[i]*this.scale*t,c.array[l]*=1-(1-p)*t,c.array[m]*=1-(1-p)*t,c.array[d]*=1-(1-p)*t,s.array[l]+=c.array[l]*t,s.array[m]+=c.array[m]*t,s.array[d]+=c.array[d]*t,o()&&(s.array[l]+=a()),o()&&(s.array[m]+=a());const{a:h}=f(i);r.array[h]*=1-(1-(Math.random()>.3?.98:.95))*t,r.array[h]<.001&&(r.array[h]=0)}s.needsUpdate=!0,c.needsUpdate=!0,r.needsUpdate=!0}}class x{constructor(e,t){this.scale=e,this.position=t,this.gravity=new m(0,0,-.005*e),this.meshGroup=new n,this.isExplode=!1;this.petalsNum=u(400,150),this.life=150,this.seed=this.getSeed(),this.meshGroup.add(this.seed.mesh),this.flowerSizeRate=a.mapLinear(this.petalsNum,150,400,.4,.7)}getSeed(){const e=[];for(let t=0;t<40;t++){const s=0,c=0,r=(0===t?2.5*Math.random()+.9:2*Math.random()+.4)*this.scale;e.push(new m(s,c,r))}const t=new y(this.scale,40,e);return t.mesh.position.set(this.position.x,this.position.y,0),t}explode(e){this.isExplode=!0,this.flower=this.getFlower(e),this.meshGroup.add(this.flower.mesh),this.meshGroup.remove(this.seed.mesh),this.seed.disposeAll()}getFlower(e){const t=this.petalsNum,s=[];let c;if(Math.random()>.5)for(let e=0;e<t;e++){c=.01*u(120,60)*this.scale;const e=a.degToRad(180*Math.random()),t=a.degToRad(360*Math.random()),r=Math.sin(e)*Math.cos(t)*c,n=Math.sin(e)*Math.sin(t)*c,o=Math.cos(e)*c,i=new m(r,n,o);i.multiplyScalar(this.flowerSizeRate),s.push(i)}else{const e=180/t,r=360*(20*Math.random()+1)/t,n=r,o=r;c=.01*u(120,60)*this.scale;for(let r=0;r<t;r++){const t=Math.sin(a.degToRad(e*r)),i=Math.cos(a.degToRad(e*r))*c,l=Math.cos(a.degToRad(n*r))*t*c,d=Math.sin(a.degToRad(o*r))*t*c,h=new m(l,d,i);h.multiplyScalar(this.flowerSizeRate),s.push(h)}}const r=new z(this.scale,t,s);return r.mesh.position.set(e.x,e.y,e.z),r}update(e){this.isExplode?(this.flower.update(this.gravity,e),this.life>0&&(this.life-=1*e)):this.drawTail(e)}drawTail(e){this.seed.update(this.gravity,e);const{position:t,velocity:s}=this.seed.mesh.geometry.attributes;let c=0,r=!0;for(let e=0,t=s.array.length;e<t;e++){2===e%3&&s.array[e]>0&&c++}if(r=0===c,!r)return;const{x:n,y:a,z:o}=this.seed.mesh.position,i=new m(n,a,o);let l,d=0;for(let e=0,s=t.array.length;e<s;e++){const s=t.array[e];2===e%3&&s>d&&(d=s,l=new m(t.array[e-2],t.array[e-1],s))}void 0!==l&&(i.add(l),this.explode(i))}}class b extends x{constructor(e,t){super(e,t);this.petalsNum=u(150,100),this.flowerSizeRate=a.mapLinear(this.petalsNum,100,150,.4,.7),this.tailMeshGroup=new n,this.tails=[]}explode(e){this.isExplode=!0,this.flower=this.getFlower(e),this.tails=this.getTail(),this.meshGroup.add(this.flower.mesh),this.meshGroup.add(this.tailMeshGroup)}getTail(){const e=[],{color:t}=this.flower.mesh.geometry.attributes;for(let s=0;s<this.petalsNum;s++){const c=[];for(let e=0;e<20;e++){c.push(new m(0,0,0))}const r=new w(this.scale,20,c),{r:n,g:a,b:o,a:i}=f(s),l=t.array[n],d=t.array[a],h=t.array[o],p=t.array[i],{position:v,color:u}=r.mesh.geometry.attributes;for(let e=0;e<v.count;e++){const{r:t,g:s,b:c,a:r}=f(e);u.array[t]=l,u.array[s]=d,u.array[c]=h,u.array[r]=p}const{x:g,y:z,z:y}=this.flower.mesh.position;r.mesh.position.set(g,z,y),e.push(r),this.tailMeshGroup.add(r.mesh)}return e}update(e){if(this.isExplode){this.flower.update(this.gravity,e);const{position:t}=this.flower.mesh.geometry.attributes;for(let s=0,c=this.tails.length;s<c;s++){const c=this.tails[s];c.update(this.gravity,e);const{x:r,y:n,z:a}=v(s),o=new m(t.array[r],t.array[n],t.array[a]),{position:i,velocity:l}=c.mesh.geometry.attributes;for(let t=0;t<i.count;t++){const{x:s,y:c,z:r}=v(t),n=new m,a=new m(i.array[s],i.array[c],i.array[r]),d=new m(l.array[s],l.array[c],l.array[r]);n.subVectors(o,a);const h=n.sub(d);h.normalize(),h.multiplyScalar(3e-4*Math.random()*this.life*this.scale*e),l.array[s]+=h.x,l.array[c]+=h.y,l.array[r]+=h.z}l.needsUpdate=!0}this.life>0&&(this.life-=1.2*e)}else this.drawTail(e)}}class k{constructor(e){const t=this;let s=performance.now();t.id=e.id,t.type="three",t.lightColor="white",t.fireworksInstances={};const c=()=>{const e=performance.now();t.tick((e-s)/(1e3/60)),s=e,requestAnimationFrame(c)};c()}onAdd(e,t){this.map=e,this.scene=t.scene}tick(e){const{fireworksInstances:t,scene:s}=this;for(const c of Object.keys(t)){const r=t[c],n=[];for(let t=r.length-1;t>=0;t--){const s=r[t];s.update(e),s.isExplode&&n.push(t)}for(let e=0,t=n.length;e<t;e++){const t=n[e],c=r[t];if(!c)return;c.meshGroup.remove(c.seed.mesh),c.seed.disposeAll(),c.life<=0&&(s.remove(c.meshGroup),c.tailMeshGroup&&c.tails.forEach((e=>{e.disposeAll()})),c.flower.disposeAll(),r.splice(t,1))}}}launchFireWorks(e,t){const s=this,{map:c,scene:r,fireworksInstances:n}=s;let a=n[e];if(a||(a=s.fireworksInstances[e]=[]),a.length>5)return;const o=c.getModelPosition(t),i=c.getModelScale(),l=Math.pow(2,17-(m=c.getZoom(),d=16,Math.min(Math.max(m,14),d)))*i;var m,d;const h={x:o.x+(400*Math.random()-200)*i,y:o.y+(400*Math.random()-200)*i},p=Math.random()>.5?new x(l,h):new b(l,h);a.push(p),r.add(p.meshGroup)}}class M{constructor(e){const t=this,{lang:s,clock:c,eventHandler:r}=e;t._lang=s,t._clock=c,t._dict={en:{"title-line-1":"Today's","title-line-2":"festivals",to:" - ",more:"and $1 more"},es:{"title-line-1":"La fiesta","title-line-2":"de hoy",to:" - ",more:"y $1 más"},fr:{"title-line-1":"Les fêtes","title-line-2":"d'aujourd'hui",to:" - ",more:"et $1 autres"},ja:{"title-line-1":"今日の","title-line-2":"花火大会",to:"〜",more:"ほか$1件"},ko:{"title-line-1":"오늘의","title-line-2":"불꽃놀이",to:" - ",more:"외 $1개"},ne:{"title-line-1":"आजका","title-line-2":"चाडपर्वहरू",to:" - ",more:"र 1 थप"},pt:{"title-line-1":"Os festivais","title-line-2":"de hoje",to:" - ",more:"e mais $1"},th:{"title-line-1":"เทศกาล","title-line-2":"วันนี้",to:" - ",more:"และอีก $1 รายการ"},"zh-Hans":{"title-line-1":"今天的","title-line-2":"烟火大会",to:" - ",more:"其他$1场"},"zh-Hant":{"title-line-1":"今天的","title-line-2":"煙火大會",to:" - ",more:"其他$1場"}},t._eventHandler=r}getDefaultPosition(){return"top-left"}onAdd(e){const t=this;return t._map=e,t._container=document.createElement("div"),t._container.className="mapboxgl-ctrl ctrl-group",t._container.style.display="none",t._element=document.createElement("div"),t._element.className="fireworks-ctrl",t._container.appendChild(t._element),t._container}onRemove(){const e=this;e._container.parentNode.removeChild(e._container),delete e._container,delete e._map}refresh(e){const t=this,s=t._dict[t._lang]||t._dict.en,c=t._container,r=t._element,n=t._clock.getTime("03:00"),a=t._clock.getTime(),o=Object.keys(e).filter((t=>{const{start:s,end:c}=e[t];return s>=n&&s<n+864e5&&c>a})),i=()=>c.classList.contains("expanded")?`min(${49*o.length+40}px, calc(100dvh - ${c.getBoundingClientRect().top+56}px))`:"";if(0!==o.length){c.style.display="block",r.innerHTML=['<div class="fireworks-header">','<div class="fireworks-title">',s["title-line-1"],"<br>",s["title-line-2"],"</div>",'<div id="fireworks-expand-button" class="fireworks-expand-button">',"</div>","</div>",'<div class="fireworks-body">','<div class="fireworks-content">',`<button id="fireworks-${o[0]}" class="fireworks-event">`,'<div class="fireworks-event-label">',e[o[0]].name[t._lang]||e[o[0]].name.en,"<br>",t._clock.getTimeString(e[o[0]].start),s.to,"</div>","</button>",'<div class="fireworks-list">',...o.slice(1).map((c=>[`<button id="fireworks-${c}" class="fireworks-event">`,'<div class="fireworks-event-label">',e[c].name[t._lang]||e[c].name.en,"<br>",t._clock.getTimeString(e[c].start),s.to,"</div>","</button>"].join(""))),"</div>",o.length>1?['<div class="fireworks-footer">',s.more.replace("$1",o.length-1),"</div>"].join(""):"","</div>","</div>"].join(""),c.style.height=i(),document.getElementById("fireworks-expand-button").addEventListener("click",(()=>{c.classList.toggle("expanded"),c.style.height=i()}));for(const e of o)document.getElementById(`fireworks-${e}`).addEventListener("click",(()=>{c.classList.remove("expanded"),c.style.height=i(),t._eventHandler({id:e})}))}else c.style.display="none"}}class C{constructor(){const e=this;e.id="fireworks",e.name={en:"Fireworks",es:"Fuegos artificiales",fr:"Feux d'artifice",ja:"花火",ko:"불꽃놀이",ne:"आतिशबाजी",pt:"Fogos de artifício",th:"ดอกไม้ไฟ","zh-Hans":"烟花","zh-Hant":"煙花"},e.iconStyle={backgroundSize:"32px",backgroundImage:"url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60 60' fill='white'%3e%3cpath d='m39 0c-0.552 0-1 0.447-1 1v11c0 0.553 0.448 1 1 1s1-0.447 1-1v-11c0-0.553-0.448-1-1-1zm-6.977 1.004c-0.1297-0.008047-0.2643 0.007734-0.3945 0.05273-0.521 0.185-0.7934 0.7554-0.6094 1.275l3.664 10.37c0.145 0.411 0.5314 0.666 0.9434 0.666 0.11 0 0.222-0.01864 0.332-0.05664 0.521-0.185 0.7934-0.7554 0.6094-1.275l-3.662-10.37c-0.138-0.3908-0.4938-0.6399-0.8828-0.6641zm14.91 0.4922c-0.3895-0.002859-0.7623 0.224-0.9258 0.6035l-4.361 10.1c-0.219 0.507 0.01548 1.095 0.5215 1.314 0.129 0.056 0.2625 0.08203 0.3945 0.08203 0.387 0 0.755-0.2255 0.918-0.6035l4.361-10.1c0.219-0.507-0.01548-1.096-0.5215-1.314-0.1262-0.05475-0.2569-0.08108-0.3867-0.08203zm-22.08 4.361c-0.2558 0-0.5115 0.09747-0.707 0.293-0.391 0.391-0.391 1.023 0 1.414l7.779 7.779c0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293c0.391-0.391 0.391-1.023 0-1.414l-7.779-7.779c-0.1955-0.1955-0.4513-0.293-0.707-0.293zm28.29 0c-0.2558 0-0.5115 0.09747-0.707 0.293l-7.779 7.779c-0.391 0.39-0.391 1.023 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293l7.779-7.779c0.391-0.391 0.391-1.023 0-1.414-0.1955-0.1955-0.4513-0.293-0.707-0.293zm-32.5 6.449c-0.3899-0.002719-0.7623 0.2221-0.9258 0.6016-0.22 0.507 0.01448 1.097 0.5215 1.316l10.1 4.359c0.129 0.056 0.2625 0.08203 0.3945 0.08203 0.387 0 0.755-0.2255 0.918-0.6035 0.219-0.507-0.01353-1.096-0.5195-1.314l-10.1-4.359c-0.127-0.0545-0.2587-0.08112-0.3887-0.08203zm37.27 0.8926c-0.1297-0.008094-0.2638 0.009937-0.3945 0.05469l-10.37 3.664c-0.521 0.185-0.7934 0.7554-0.6094 1.275 0.145 0.411 0.5314 0.666 0.9434 0.666 0.11 0 0.222-0.01864 0.332-0.05664l10.37-3.664c0.521-0.185 0.7934-0.7554 0.6094-1.275-0.1388-0.3908-0.4918-0.6398-0.8809-0.6641zm-18.92 1.801c-3.309 0-6 2.691-6 6s2.691 6 6 6 6-2.691 6-6-2.691-6-6-6zm-20 5c-0.552 0-1 0.447-1 1s0.448 1 1 1h11c0.552 0 1-0.447 1-1s-0.448-1-1-1h-11zm29 0c-0.553 0-1 0.447-1 1s0.447 1 1 1h11c0.553 0 1-0.447 1-1s-0.447-1-1-1h-11zm-33 1c-0.552 0-1 0.447-1 1v2c0 0.553 0.448 1 1 1s1-0.447 1-1v-2c0-0.553-0.448-1-1-1zm-4.879 1.01c-0.1289-0.01612-0.2618-0.009407-0.3945 0.02734-0.532 0.152-0.8395 0.7053-0.6875 1.236l0.5488 1.924c0.125 0.439 0.5259 0.7266 0.9609 0.7266 0.091 0 0.1844-0.01406 0.2754-0.03906 0.531-0.152 0.8385-0.7053 0.6875-1.236l-0.5488-1.922c-0.114-0.3982-0.4551-0.6684-0.8418-0.7168zm10.94 0.9922c-0.3893-0.02452-0.7737 0.1803-0.959 0.5508l-0.7637 1.527c-0.248 0.495-0.04773 1.097 0.4473 1.344 0.144 0.071 0.2953 0.1035 0.4453 0.1035 0.367 0 0.7205-0.2017 0.8965-0.5527l0.7637-1.527c0.247-0.494 0.04674-1.095-0.4473-1.342-0.124-0.06125-0.253-0.09534-0.3828-0.1035zm9.531 0.2344c-0.1294-0.01069-0.2635 0.003625-0.3945 0.04688l-6.514 2.145c-0.525 0.173-0.8097 0.7387-0.6367 1.264 0.138 0.421 0.5292 0.6875 0.9492 0.6875 0.104 0 0.2095-0.01483 0.3125-0.04883l6.514-2.146c0.525-0.173 0.8097-0.7367 0.6367-1.262-0.1298-0.3938-0.4791-0.6535-0.8672-0.6855zm16.67 0.1895c-0.3899-0.00314-0.7603 0.224-0.9238 0.6035-0.219 0.507 0.01353 1.096 0.5195 1.314l10.1 4.359c0.129 0.056 0.2645 0.08203 0.3965 0.08203 0.388 0 0.755-0.2255 0.918-0.6035 0.218-0.505-0.01448-1.094-0.5215-1.312l-10.1-4.361c-0.127-0.05525-0.2587-0.08098-0.3887-0.08203zm-42.18 1.578c-0.2549-0.023-0.519 0.05202-0.7305 0.2285-0.424 0.354-0.48 0.9832-0.127 1.408l1.279 1.537c0.198 0.237 0.4825 0.3574 0.7695 0.3574 0.226 0 0.4536-0.07547 0.6406-0.2305 0.424-0.354 0.481-0.9842 0.127-1.408l-1.281-1.537c-0.177-0.2125-0.4229-0.3325-0.6777-0.3555zm9.91 0.9961c-0.552 0-1 0.447-1 1v2c0 0.553 0.448 1 1 1s1-0.447 1-1v-2c0-0.553-0.448-1-1-1zm17.64 0.3633c-0.2558 0-0.5115 0.09747-0.707 0.293l-6.637 6.637c-0.391 0.391-0.391 1.023 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293l6.637-6.637c0.391-0.391 0.391-1.023 0-1.414-0.1955-0.1955-0.4513-0.293-0.707-0.293zm12.73 0c-0.2558 0-0.5115 0.09747-0.707 0.293-0.391 0.391-0.391 1.023 0 1.414l7.779 7.779c0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293c0.391-0.391 0.391-1.023 0-1.414l-7.779-7.779c-0.1955-0.1955-0.4513-0.293-0.707-0.293zm-33.87 0.4531c-0.129-0.01617-0.2618-0.007203-0.3945 0.0293-0.531 0.152-0.8385 0.7034-0.6875 1.234l0.5488 1.924c0.126 0.44 0.5259 0.7266 0.9609 0.7266 0.091 0 0.1844-0.01406 0.2754-0.03906 0.531-0.152 0.8385-0.7053 0.6875-1.236l-0.5488-1.922c-0.1133-0.3982-0.4549-0.6683-0.8418-0.7168zm7.465 0.3965c-0.3897-0.02438-0.7737 0.1803-0.959 0.5508l-0.8945 1.789c-0.247 0.494-0.04674 1.095 0.4473 1.342 0.144 0.071 0.2953 0.1055 0.4453 0.1055 0.367 0 0.7205-0.2017 0.8965-0.5527l0.8945-1.789c0.247-0.494 0.04869-1.095-0.4453-1.342-0.1242-0.0615-0.2549-0.09539-0.3848-0.1035zm16.48 0.9082c-0.3899-0.002719-0.7603 0.2221-0.9238 0.6016l-4.361 10.1c-0.219 0.507 0.01548 1.096 0.5215 1.314 0.129 0.056 0.2625 0.08203 0.3945 0.08203 0.387 0 0.755-0.2275 0.918-0.6055l4.361-10.1c0.219-0.505-0.01548-1.095-0.5215-1.314-0.127-0.0545-0.2587-0.07917-0.3887-0.08008zm6.617 0.2266c-0.1297-0.008047-0.2623 0.007735-0.3926 0.05274-0.521 0.185-0.7934 0.7573-0.6094 1.277l3.664 10.37c0.145 0.411 0.5294 0.668 0.9414 0.668 0.11 0 0.224-0.02059 0.334-0.05859 0.521-0.185 0.7934-0.7554 0.6094-1.275l-3.664-10.37c-0.138-0.3908-0.4938-0.6399-0.8828-0.6641zm-3.057 0.4062c-0.552 0-1 0.447-1 1v7.525c0 0.553 0.448 1 1 1s1-0.447 1-1v-7.525c0-0.553-0.448-1-1-1zm-30.71 0.08984c-0.2549-0.023-0.519 0.05202-0.7305 0.2285-0.424 0.354-0.48 0.9842-0.127 1.408l1.281 1.537c0.198 0.238 0.4806 0.3594 0.7676 0.3594 0.226 0 0.4536-0.07547 0.6406-0.2305 0.423-0.353 0.48-0.9842 0.127-1.408l-1.281-1.539c-0.177-0.2125-0.4229-0.3325-0.6777-0.3555zm16.46 0.1562c-0.552 0-0.9961 0.447-0.9961 1s0.4539 1 1.006 1c0.553 0 1-0.447 1-1s-0.447-1-1-1h-0.009766zm-22.75 0.998c-0.39-0.002625-0.7611 0.2264-0.9238 0.6074-0.218 0.507 0.01739 1.096 0.5254 1.314l1.838 0.7871c0.128 0.056 0.2625 0.08008 0.3945 0.08008 0.388 0 0.7579-0.2265 0.9199-0.6055 0.218-0.507-0.01739-1.094-0.5254-1.312l-1.838-0.7891c-0.1272-0.0555-0.2606-0.08116-0.3906-0.08203zm20.49 0.8125c-0.2532-0.03612-0.5202 0.02591-0.7422 0.1914l-1.6 1.199c-0.442 0.331-0.5322 0.9574-0.2012 1.398 0.196 0.262 0.4968 0.4004 0.8008 0.4004 0.208 0 0.4196-0.06422 0.5996-0.1992l1.6-1.201c0.442-0.331 0.5322-0.9574 0.2012-1.398-0.165-0.221-0.405-0.3545-0.6582-0.3906zm-15.9 1.158c-0.3897-0.002203-0.7611 0.2264-0.9238 0.6074-0.218 0.507 0.01544 1.094 0.5234 1.312l1.838 0.7891c0.128 0.056 0.2625 0.08008 0.3945 0.08008 0.388 0 0.7579-0.2265 0.9199-0.6055 0.218-0.507-0.01739-1.094-0.5254-1.312l-1.838-0.7891c-0.1268-0.05475-0.2588-0.0813-0.3887-0.08203zm8.223 0.7539c-1.919 0-3.48 1.56-3.48 3.479 0 1.919 1.562 3.48 3.48 3.48 1.919 0 3.479-1.562 3.479-3.48 0-1.919-1.56-3.479-3.479-3.479zm-13.82 2.654c-0.552 0-1 0.447-1 1s0.448 1 1 1h2c0.552 0 1-0.447 1-1s-0.448-1-1-1h-2zm5 0c-0.552 0-1 0.447-1 1s0.448 1 1 1h2c0.552 0 1-0.447 1-1s-0.448-1-1-1h-2zm15.62 0.2441c-0.552 0-1 0.447-1 1s0.448 1 1 1h2c0.552 0 1-0.447 1-1s-0.448-1-1-1h-2zm6.395 0.0293c-0.552 0-0.9961 0.447-0.9961 1s0.4539 1 1.006 1c0.553 0 1-0.447 1-1s-0.447-1-1-1h-0.009766zm-19.16 2.436c-0.129-0.01617-0.2637-0.007204-0.3965 0.0293l-1.922 0.5488c-0.531 0.152-0.8395 0.7053-0.6875 1.236 0.125 0.44 0.5259 0.7266 0.9609 0.7266 0.091 0 0.1834-0.01406 0.2754-0.03906l1.924-0.5488c0.531-0.152 0.8375-0.7053 0.6855-1.236-0.1132-0.3982-0.4529-0.6683-0.8398-0.7168zm12.13 0.9121c-0.3902 0.0075-0.7552 0.2454-0.9082 0.6309-0.206 0.513 0.04364 1.096 0.5566 1.301l1.857 0.7422c0.122 0.049 0.2481 0.07031 0.3711 0.07031 0.397 0 0.7707-0.2369 0.9277-0.6289 0.205-0.512-0.04464-1.093-0.5566-1.299l-1.857-0.7441c-0.1288-0.0515-0.2605-0.07476-0.3906-0.07226zm18.02 0.1699c-0.552 0-1 0.447-1 1v2.889c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.889c0-0.553-0.448-1-1-1zm-34.96 0.291c-0.1289-0.01611-0.2635-0.007453-0.3965 0.0293l-1.924 0.5488c-0.531 0.152-0.8385 0.7073-0.6875 1.238 0.126 0.439 0.5269 0.7246 0.9629 0.7246 0.091 0 0.1844-0.01211 0.2754-0.03711l1.922-0.5508c0.531-0.152 0.8395-0.7053 0.6875-1.236-0.114-0.3975-0.453-0.6685-0.8398-0.7168zm5.904 0.5898c-0.256 0-0.5115 0.09942-0.707 0.2949l-1.414 1.414c-0.39 0.391-0.39 1.024 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293 0.256 0 0.512-0.09797 0.707-0.293l1.414-1.414c0.39-0.391 0.39-1.024 0-1.414-0.1955-0.1955-0.451-0.2949-0.707-0.2949zm15.67 0.8066c-0.3897 0.007875-0.7545 0.2461-0.9082 0.6309-0.205 0.513 0.04559 1.095 0.5586 1.299l0.3574 0.1445c0.121 0.049 0.2451 0.07031 0.3691 0.07031 0.397 0 0.7737-0.2389 0.9297-0.6309 0.204-0.513-0.04659-1.095-0.5586-1.299l-0.3574-0.1426c-0.1288-0.05175-0.2607-0.07489-0.3906-0.07226zm-7.434 0.541c-0.1275 0.02431-0.2524 0.07389-0.3672 0.1504-0.459 0.307-0.5814 0.9267-0.2754 1.387l1.107 1.664c0.193 0.289 0.511 0.4453 0.834 0.4453 0.19 0 0.3837-0.05497 0.5547-0.168 0.46-0.307 0.5824-0.9267 0.2754-1.387l-1.107-1.664c-0.231-0.345-0.639-0.5007-1.021-0.4277zm-6.127 0.6055c-0.3892-0.02466-0.7718 0.1803-0.957 0.5508l-0.7637 1.527c-0.247 0.494-0.04869 1.095 0.4453 1.342 0.144 0.071 0.2973 0.1055 0.4473 0.1055 0.367 0 0.7205-0.2017 0.8965-0.5527l0.7637-1.529c0.248-0.493 0.04674-1.092-0.4473-1.34-0.1238-0.0615-0.255-0.0953-0.3848-0.1035zm2.963 0.4375c-0.552 0-1 0.447-1 1v3.959c0 0.553 0.448 1 1 1s1-0.447 1-1v-3.959c0-0.553-0.448-1-1-1zm-8.611 1.146c-0.2558 0-0.5115 0.09747-0.707 0.293l-1.414 1.414c-0.391 0.391-0.391 1.023 0 1.414 0.195 0.195 0.451 0.293 0.707 0.293s0.512-0.09797 0.707-0.293l1.414-1.414c0.391-0.391 0.391-1.023 0-1.414-0.1955-0.1955-0.4513-0.293-0.707-0.293zm32.59 1.357c-0.552 0-1 0.447-1 1v2.891c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.891c0-0.552-0.448-1-1-1zm-18.04 0.6113c-0.1276 0.02436-0.2522 0.07559-0.3672 0.1523-0.46 0.307-0.5833 0.9267-0.2773 1.387l1.109 1.664c0.193 0.289 0.511 0.4453 0.834 0.4453 0.19 0 0.3817-0.05497 0.5527-0.168 0.459-0.307 0.5843-0.9287 0.2773-1.389l-1.109-1.662c-0.2302-0.345-0.6367-0.5028-1.02-0.4297zm-11 0.6582c-0.3892-0.02438-0.7737 0.1803-0.959 0.5508l-0.8945 1.789c-0.247 0.494-0.04673 1.095 0.4473 1.342 0.144 0.071 0.2953 0.1055 0.4453 0.1055 0.367 0 0.7205-0.2017 0.8965-0.5527l0.8945-1.789c0.246-0.494 0.04674-1.095-0.4473-1.342-0.1238-0.0615-0.2531-0.09539-0.3828-0.1035zm5.066 3.072c-0.552 0-1 0.447-1 1v2.891c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.891c0-0.552-0.448-1-1-1zm23.97 1.438c-0.552 0-1 0.447-1 1v2.889c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.889c0-0.553-0.448-1-1-1zm-23.97 4.342c-0.552 0-1 0.447-1 1v2.889c0 0.553 0.448 1 1 1s1-0.447 1-1v-2.889c0-0.553-0.448-1-1-1zm23.97 1.436c-0.552 0-1 0.447-1 1v1.5c0 0.553 0.448 1 1 1s1-0.447 1-1v-1.5c0-0.553-0.448-1-1-1z'/%3e%3c/svg%3e\")"},e.viewModes=["ground"],e.layer=new k({id:e.id}),e.events={},e.activeEvents={}}onAdd(e){const t=this,{lang:s,clock:c}=t.map=e;e.addLayer(t.layer),t.fireworksCtrl=new M({lang:s,clock:c,eventHandler:({id:s})=>{e.flyTo({center:t.events[s].center,zoom:15,pitch:60})}})}onRemove(e){e.removeLayer(this.id)}onEnabled(){const e=this;e.map.getMapboxMap().addControl(e.fireworksCtrl),e.dataInterval=h((()=>{fetch("https://mini-tokyo.appspot.com/fireworks").then((e=>e.json())).then((t=>{e._updateEvents(t),e._updateActiveEvents(),e.fireworksCtrl.refresh(e.events)}))}),3e5);const t=()=>{const s=e.map.clock.getTime();Math.floor(s/6e4)!==Math.floor(e._lastActivityRefresh/6e4)&&(e._updateActiveEvents(),e.fireworksCtrl.refresh(e.events),e._lastActivityRefresh=s),e._frameRequestID=requestAnimationFrame(t)};t(),e.interval=h((()=>{if(e.visible)for(const t of Object.keys(e.activeEvents))Math.random()>.7&&e.layer.launchFireWorks(t,e.activeEvents[t].center)}),100)}onDisabled(){const e=this;clearInterval(e.dataInterval),cancelAnimationFrame(e._frameRequestID),delete e._lastActivityRefresh,clearInterval(e.interval),e._updateEvents([]),e.map.getMapboxMap().removeControl(e.fireworksCtrl)}onVisibilityChanged(e){const t=this,{map:s,activeEvents:c}=t;t.visible=e;for(const t of Object.keys(c))c[t].marker.setVisibility(e);s.setLayerVisibility(t.id,e?"visible":"none")}_updateEvents(t){const{map:s,events:c,activeEvents:r}=this;for(const r of t){const t=r.id,n=c[t];if(n){n.marker.setLngLat(r.center),n.updated=!0;continue}const a=d("div",{className:"fireworks-marker",innerHTML:r.name[s.lang]||r.name.en}),o=new e.Marker({element:a}).setLngLat(r.center).addTo(s).setVisibility(!1).on("click",(()=>{s.flyTo({center:c[t].center,zoom:15,pitch:60})}));o._marker.setOffset([0,40]),c[t]=Object.assign({marker:o,updated:!0},r)}for(const e of Object.keys(c))c[e].updated?delete c[e].updated:(c[e].marker.remove(),delete c[e],delete r[e])}_updateActiveEvents(){const e=this,t=e.map.clock.getTime();for(const s of Object.keys(e.events)){const c=e.events[s],r=t>=c.start&&t<c.end;r&&!e.activeEvents[s]?(e.activeEvents[s]=c,c.marker.setVisibility(e.visible)):!r&&e.activeEvents[s]&&(delete e.activeEvents[s],c.marker.setVisibility(!1))}}}return function(){return new C}}));
//# sourceMappingURL=mt3d-plugin-fireworks.min.js.map
